<%@ page language="java" import="java.util.*" pageEncoding="UTF-8"%>
<%@include file="/include/taglib.jsp"%>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
	<head>
		<title>融资谷-手机注册</title>

		<meta http-equiv="pragma" content="no-cache" />
		<meta http-equiv="cache-control" content="no-cache" />
		<meta http-equiv="expires" content="0" />
		<meta http-equiv="keywords" content="keyword1,keyword2,keyword3" />
		<meta http-equiv="description" content="This is my page" />
		<link rel="stylesheet" href="css/style.css" type="text/css"></link>
		<link rel="stylesheet" href="css/base.css" type="text/css"></link>
		<link href="css/inside.css" rel="stylesheet" type="text/css" />
		<link href="css/css.css" rel="stylesheet" type="text/css" />
		<link id="skin" rel="stylesheet" href="css/jbox/Gray/jbox.css" />
		<script type="text/javascript" src="js/jquery.js"></script>
		<script type="text/javascript" src="js/common.js"></script>
		<style type="text/css">
ul,li {
	margin: 0;
	padding: 0
}

#scrollDiv {
	height: 182px;
	overflow: hidden
}
</style>
	</head>
	<body>
		<%-- 引用头部公共部分 --%>
		<jsp:include page="/include/topref.jsp"></jsp:include>
		<div class="nymain">
			<div class="bigbox">
				<div class="til">
					手机会员注册
				</div>
				<div class="sqdk"
					style="padding-top: 55px; padding-bottom: 80px; padding-left: 60px;">
					<div class="logintab">
						<form action="register.htm" method="post">
							<s:hidden name="paramMap.param" id="param" />
							<table width="100%" border="0" cellspacing="0" cellpadding="0">
								<tr>
									<th align="right">
										<span class="fred">*&nbsp;</span>手机号：
									</th>
									<td>
										<input type="text" class="inp202" name="paramMap.cellphone"
											id="cellphone" />
									</td>
									<td width="100px">
										<span style="color: red" id="s_cellphone" class="formtips"></span>
									</td>
								</tr>
								<tr>
									<th align="right">
										<span class="fred">*&nbsp;</span>验证码：
									</th>
									<td>
										<input type="text" class="inp100" name="paramMap.code"
											id="code" />
										<img src="admin/imageCode.do?pageId=cellphone" title="点击更换验证码"
											style="cursor: pointer;" id="codeNum" width="46" height="18"
											onclick=
	javascript:
	;
;
;
;
;
switchCode();
/>
										<a href="javascript:void()" onclick=
	switchCode();;;;;;
style="color: blue;">换一换?</a>
									</td>
									<td width="80px">
										<span style="color: red" id="s_code" class="formtips"></span>
									</td>
								</tr>
								<s:if test="#session.DEMO==1">
									<tr>
										<td>
											&nbsp;
										</td>
										<td>
											<span style="color: red; font-size: 12px">* 不发送短信</span>
										</td>
									</tr>
								</s:if>
								<tr>
									<th align="right">
										&nbsp;
									</th>
									<td class="tyzc">
										<input type="checkbox" id="agre" checked="checked" />
										我已经阅读并同意
										<a style="cursor: pointer;" onclick=
	fff();
>使用条款</a>和
										<a style="cursor: pointer;" onclick=
	ffftip();
>隐私条款</a>
									</td>
								</tr>
								<tr>
									<th align="right">
										&nbsp;
									</th>
									<%--  <td><a href="yxjihuo.html" class="zcbtn">免费注册</a></td> --%>
									<td>
										<input type="button" id="btn_cellreg" value="提交" class="zcbtn"
											style="cursor: pointer;" />
									</td>
								</tr>
							</table>
						</form>
						<div class="loginbtn">
							<div class="dlbtn1">
								已有账号，
								<a href="login.htm">马上登录</a>
							</div>
						</div>
					</div>
					<div class="zcdl_right">
						<span id="s3_k_c_abq_d_prev" class="zzry_prev"></span>
						<div id="s3_k_c_abq_d" class="zzry_pic">
							<ul>
								<li>
									<a href="newhelp.htm"><img src="images/img/tzlc.jpg" />
									</a>
								</li>
								<li>
									<a href="borrowhelp.htm"><img src="images/img/jkrz.jpg" />
									</a>
								</li>
								<li>
									<a href="safety.htm"><img src="images/img/aqbz.jpg" />
									</a>
								</li>

							</ul>
						</div>
						<span id="s3_k_c_abq_d_next" class="zzry_next"></span>
						<script>
	jQuery("#s3_k_c_abq_d").jCarouselLite( {
		btnNext : "#s3_k_c_abq_d_next",
		btnPrev : "#s3_k_c_abq_d_prev",
		auto : 3000,
		speed : 300,
		visible : 1,
		scroll : 1
	});
</script>
					</div>


				</div>
			</div>
		</div>
		<%-- 引用底部公共部分 --%>
		<jsp:include page="/include/footer.jsp"></jsp:include>
		<script type="text/javascript" src="script/nav-zh.js"></script>
		<script type="text/javascript" src="css/popom.js"></script>
		<script src="script/jquery-1.7.1.min.js" type="text/javascript"></script>
		<script type="text/javascript"
			src="script/jbox/jquery.jBox-2.3.min.js"></script>
		<script type="text/javascript" src="script/jbox/jquery.jBox-zh-CN.js"></script>
		<script>
	//弹出隐私条款和使用条款
	function fff() {
		jQuery.jBox.open("post:querytips.htm", "使用条款", 600, 400, {
			buttons : {}
		});
	}
	function ffff() {
		ClosePop();
	}
</script>
		<script>
	function ffftip() {
		jQuery.jBox.open("post:querytip.htm", "隐私条款", 600, 400, {
			buttons : {}
		});
	}
</script>
		<script>
	//回车登录
	document.onkeydown = function(e) {
		if (!e)
			e = window.event;
		if ((e.keyCode || e.which) == 13) {
			cellreg();
		}
	}
</script>
		<script>
	$(function() {
		$("form :input").blur(function() {
			//手机号码
				if ($(this).attr("id") == "cellphone") {
					if ((!/^1[3,4,5,8]\d{9}$/.test($("#cellphone").val()))) {
						$("#s_cellphone").attr("class", "formtips onError");
						$("#s_cellphone").html("手机号码格式错误");
					} else {
						$("#s_cellphone").attr("class", "formtips");
						$("#s_cellphone").html("");
					}
				}
				//验证码
				if ($(this).attr("id") == "code") {
					if ($(this).val() == "") {
						$("#s_code").attr("class", "formtips onError");
						$("#s_code").html("验证码不正确");
					} else {
						$("#s_code").attr("class", "formtips");
						$("#s_code").html("");
					}
				}
			});
	});
</script>
		<script>
	//初始化验证码
	function switchCode() {
		var timenow = new Date();
		$("#codeNum").attr("src",
				"admin/imageCode.do?pageId=cellphone&d=" + timenow);
	}
</script>
		<script>
	var falg = true;
	function cellreg() {
		var errornum = $("form .onError").length;
		if (falg) {
			falg = false;
			if ($("#cellphone").val() == "") {
				$("#s_cellphone").html("手机号码格式错误");
				falg = true;
				switchCode();
				return false;
			}
			if ($("#code").val() == "") {
				$("#s_code").html("验证码不正确");
				falg = true;
				switchCode();
				return false;
			}
			if (!$("#agre").attr("checked")) {
				alert("请勾选我已阅读并同意《使用条款》和《隐私条款》");
				falg = true;
				return false;
			}
			var param = {};
			param["paramMap.cellphone"] = $("#cellphone").val();
			param["paramMap.pageId"] = "cellphone";
			param["paramMap.code"] = $("#code").val();
			$
					.post("cellPhoneregsinit.htm",
							param,
							function(da) {
								if (da == 1) {
									var cellph = $("#cellphone").val();
									if ('${DEMO}' != 1) {
										/**发送手机验证码**/
										var phone = $("#cellphone").val();
										var code = $("#code").val();//只有手机注册页面需要code
							$
									.post(
											"phoneCheck.htm",
											"phone=" + phone + "&code=" + code,
											function(datas) {
												if (datas.ret != 1) {
													alert(datas.msg);
													return;
												}
												phone = datas.phone;
												var test = {};
												test["paramMap.phone"] = phone;
												test["paramMap.pageId"] = "cellphone";//只有手机注册页面需要pageId 
												$
														.post(
																"sendSMSNew.htm",
																test,
																function(data) {
																	if (data == 1) {
																		window.location.href = 'cellPhonereginit.htm';
																	} else {
																		alert("手机验证码发送失败");
																	}
																});
											});
						} else {
							window.location.href = 'cellPhonereginit.htm';
						}
					} else if (da == 2) {
						$("#s_code").html("验证码不正确");
						falg = true;
						switchCode();
					} else if (da == 3) {
						$("#s_cellphone").html("手机号码格式错误");
						falg = true;
						switchCode();
					} else if (da == 5) {
						$("#s_cellphone").html("手机号已存在!");
						falg = true;
						switchCode();
					}
				}	);
		}
	}
</script>
		<script>
	//提交
	$(function() {
		$("#btn_cellreg").click(function() {
			cellreg();
		});
	});
</script>
	</body>
</html>
