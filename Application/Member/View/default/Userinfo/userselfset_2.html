<block name="body">
<extend name="Base/common"/>
<block name="body">
		<!-- 引用头部公共部分 -->
		<jsp:include page="/include/topref.jsp"></jsp:include>
		<div class="nymain">
			<div class="wdzh">
				<div class="l_nav">
					<div class="box">
						<!-- 引用我的帐号主页左边栏 -->
						<include file="Public/left"/>
					</div>
				</div>
				<div class="r_main">
					<div class="tabtil">
						<ul>
							<li class="on" onclick="jumpUrl('owerInformationInit.htm');">
								基本信息
							</li>
							<%--		<li onclick="loadWorkInit('queryWorkInit.htm');">
								工作认证信息
							</li> 
							<li onclick="jumpUrl('updatexgmm.htm');">
								修改密码
							</li>
							<li id="li_bp" onclick="bindingPhoneLoad('boundcellphone.htm');">
								更换手机
							</li>
							<li onclick="jumpUrl('emailManagerInit.htm');">
								邮箱设置
							</li>
							<li onclick="jumpUrl('szform.htm');">
								通知设置
							</li>
							<li id="li_tx" onclick="loadBankInfo('yhbound.htm');">
								银行卡设置
							</li>--%>
						</ul>
					</div>

					<!-- 个人详细信息位置 开始 -->
					<div class="box" id="baseinfo">
						<div class="boxmain2">
							<p class="tips">
								<span class="fred">*</span> 为必填项，所有资料均会严格保密。
								<span style="color: #DB7017">*</span> &nbsp;成为借款人必填项。
							</p>
							<form id="BaseDataform">
								<div class="biaoge2">

									<table width="100%" border="0" cellspacing="0" cellpadding="0">
										<tr>
											<td align="right">
												<span style="color: red; float: none;" class="formtips">*</span>真实姓名：
											</td>
											<td>
												<s:if test='#request.flag=="2"'>
													<input type="text" class="inp188" name="paramMap.realName"
														id="realName"
														<s:if test='#request.map.auditStatus ==3'>disabled="disabled"</s:if> />
													<span style="color: red; float: none;" id="u_realName"
														class="formtips"></span>
												</s:if>
												<s:else>
												  ${map.realName}
												  <input type="hidden" class="inp188"
														name="paramMap.realName" id="realName"
														value="${map.realName}" />
												</s:else>

											</td>
										</tr>
										<tr>
											<td align="right">
												<span style="color: red; float: none;" class="formtips">*</span>身份证号：
											</td>
											<td>
												<s:if test='#request.flag=="2"'>
													<input type="text" class="inp188" name="paramMap.idNo"
														id="idNo" />
													<span style="color: red; float: none;" id="u_idNo"
														class="formtips"></span>
												</s:if>
												<s:else>
													<a id='idNo1'></a>
													<input type="hidden" class="inp188" name="paramMap.idNo"
														id="idNo" value="${map.idNo}" />
												</s:else>
											</td>
										</tr>
										<tr>
											<td align="right">
												<span style="color: red; float: none;" class="formtips">*</span>手机号码：
											</td>
											<td>
												<s:if test="#request.map.cellPhone!=null">
													<a id="cellPhone1"></a>
													<input type="hidden" class="inp188"
														name="paramMap.cellPhone" id="cellPhone"
														value="${map.cellPhone}" />
												</s:if>
												<s:else>
													<s:if test='#request.flag=="2"'>
														<input type="text" class="inp188"
															name="paramMap.cellPhone" id="cellPhone" />
														<a id="clickCode5" class="yzmbtn" style="cursor: pointer;">点击获取验证码</a>

														<span style="color: red; float: none;" id="u_cellPhone"
															class="formtips"></span>
													</s:if>
													<s:else>
														<a id="cellPhone1"></a>
														<input type="hidden" class="inp188"
															name="paramMap.cellPhone" id="cellPhone"
															value="${map.cellPhone}" />
													</s:else>
												</s:else>
											</td>
										</tr>
										<s:if test="#request.map.cellPhone!=null">
											<input type="hidden" class="inp100x" name="iscellPhone"
												id="vilidataNum" value="${map.cellPhone}" />
										</s:if>
										<s:else>
											<s:if test='#request.flag=="2"'>
												<tr>
													<td align="right">
														<span style="color: red; float: none;" class="formtips">*</span>手机验证码：
													</td>
													<td>
														<input type="text" class="inp100x"
															name="paramMap.vilidataNum" id="vilidataNum" />
														<s:if test="#request.ISDEMO==1">
															<span style="color: red; float: none;" id="u_vilidat2"
																class="formtips"> * 不发送验证码，随意填写. </span>
														</s:if>
														<span style="color: red; float: none;" id="u_vilidataNum"
															class="formtips"> </span>
													</td>
												</tr>

											</s:if>
											<s:else>

											</s:else>
										</s:else>
										<tr id="grtx">
											<td align="right" id="personalHead">
												个人头像：
											</td>
											<td>
												<input type="button" id="btn_personalHead" class="scbtn"
													style="cursor: pointer;" value="点击上传"
													<s:if test='#request.map.auditStatus ==3'>disabled="disabled"</s:if> />
											</td>
										</tr>
										<tr>
											<td align="right">
												&nbsp;

											</td>
											<td class="tx">
												<shove:img id="img" defaulImg="images/default-img.jpg"
													src="${map.personalHead}" width="62" height="62"></shove:img>
											</td>
										</tr>


										<tr>
											<td align="right">
												&nbsp;

											</td>
											<td class="tishi">
												请确保您填写的资料真实有效，所有资料将会严格保密。
												<br />
												一旦被发现所填资料有虚假，将会影响您在融资谷的信用，对以后借款造成影响。
											</td>
										</tr>
										<!-- <tr>
											<td align="right">
												&nbsp;

											</td>
											<td style="padding-top: 20px;">
												 
												<s:if test="#session.user.map.auditStatus==3"></s:if>
												<s:else>
												
												<input type="button" value="保存" class="bcbtn" id="jc_btn"
													<s:if test='#request.map.auditStatus ==3'>disabled="disabled"</s:if> />
												</s:else>	
											</td>
										</tr>-->
									</table>


								</div>
								<p class="tips">
									<span class="fred">*</span> 为必填项，所有资料均会严格保密。
									<span style="color: #DB7017">*</span> &nbsp;身份证上传为必填项。
									<span style="color: #DB7017">*</span> &nbsp;
									<a href="#" id="uploadOk" style="display: none;"
										onclick="updateFiledatefirest('1')"><img
											src="images/sys/shangchuan.png" /> </a>
									<span style="color: #DB7017"></span>
									<a href="#" id="uploadNo" style="display: none;"><img
											src="images/sys/quxiao_ok.png" /> </a>
								</p>
								<!-- 身份证认证开始 start -->
								<div class="rzbox" id="shencard">
									<h3>
										<span class="fred">*</span>身份证认证
									</h3>
									<p class="txt">
										&nbsp;
									</p>
									<div class="jbrz">
										<ul>
											<s:if test="#request.basepictur==null">
												<tr align="center" class="gvItem">
													<td colspan="10">
														暂无数据
													</td>
												</tr>
											</s:if>
											<s:else>

												<s:iterator value="#request.basepictur" var="bean"
													status="sta">

													<li
														<s:if test="#sta.count==3">style="margin-right:0px;"</s:if>
														<s:if test="#sta.count==4">style="margin-bottom:0px;"</s:if>
														<s:if test="#sta.count==5">style="margin-bottom:0px;"</s:if>>
														<div class="pic">
															<img src="images/baseimage_${sta.count}.jpg" width="62"
																height="62" id="img_identiy" />
														</div>
														<div class="shangchuan">
															<h3>
																${tmyname }
															</h3>
															<input type="button" class="scbtn"
																style="cursor: pointer;" value="点击上传" onclick=fff();;;;; />
														</div>
														<div class="shico">
															<s:if test="#bean.auditStatus==1"> 审核中</s:if>
															<s:elseif test="#bean.auditStatus==2">失败</s:elseif>
															<s:elseif test="#bean.auditStatus==3">成功</s:elseif>
															<s:else>待上传</s:else>
														</div>
													</li>
												</s:iterator>
											</s:else>
										</ul>
										<span> <font color="red">温馨提示：请确保您填写的资料真实有效，所有资料将会严格保密。</font>
										</span>
										<br />
										<br />
										<span> <font color="red">一旦被发现所填资料有虚假，将会影响您在融资谷的信用，对以后借款造成影响。</font>
										</span>
										<span><a href=""></a>&nbsp;&nbsp;&nbsp;</span>
										<div class="clear"></div>
									</div>
								</div>

								<!-- 弹出层开始  start -->
								<div id="tanchu" style="display: none;">
									<!-- 引用头部公共部分 -->
									<div class="r-main"
										style="border: none; float: none; width: auto;">
										<div class="rmainbox"
											style="padding-left: 0px; padding-right: 0px; padding: 0px;">
											<div class="tcbox"
												style="display: -none; position: static; margin: 0px auto; padding: 0px;">
												<div class="tcmain">
													<h3>
														已上传资料：
													</h3>
													<div class="">
														<table width="100%" border="0" cellspacing="0"
															cellpadding="0" id="sssd">
															<tr id="fg">
																<th align="center">
																	选中
																</th>
																<th align="center">
																	序号
																</th>
																<th align="center">
																	名称
																</th>
																<th align="center">
																	图片
																</th>
																<th align="center">
																	状态
																</th>
																<th align="center">
																	操作
																</th>
															</tr>
															<s:if
																test="#request.userPicDate==null || request.userPicDate.size == 0 ">
																<tr align="center" class="gvItem">
																	<td colspan="6">
																		暂无数据
																	</td>
																</tr>
															</s:if>
															<s:else>
																<s:iterator value="#request.userPicDate" var="bean"
																	status="st">
																	<tr id='s_${st.count }'>
																		<td align="center">
																			<input type="checkbox" name="items" id="${st.count }"
																				value="${id}"
																				<s:if test="#bean.visiable==1">checked="checked"</s:if> />
																		</td>
																		<td align="center">
																			${st.count }
																		</td>
																		<td align="center">
																			${tmyname }${st.count }
																		</td>
																		<td align="center" class="pic">
																			<a href="${imagePath }" target="_blank" title="查看图片"><img
																					src="${imagePath }" width="62" height="62" />
																			</a>

																		</td>
																		<td align="center">
																			<s:if test="#bean.auditStatus==1">审核中</s:if>
																			<s:if test="#bean.auditStatus==2">失败</s:if>
																			<s:if test="#bean.auditStatus==3">通过</s:if>
																		</td>
																		<td align="center">
																			-
																		</td>
																	</tr>
																</s:iterator>
															</s:else>
															<tr id="ggggs">
																<td colspan="5" style="border: none; padding-top: 10px;">
																	<a style="padding-left: 6.5%"> <input
																			type="checkbox" name="checkbox4" id="select" /> 全选 </a>
																	<a style="color: red"> 提示：选中资料可见</a>
																</td>
															</tr>
														</table>

													</div>
													<div class="xzzl">
														<table width="100%" border="0" cellspacing="0"
															cellpadding="0">
															<tr id="mytable">
																<!-- <th align="left" width="19%">
														选择资料：
													</th> -->
																<td align="left">
																	<input type="hidden" value="${tmid }"
																		name="paramMap.tmid" id="hahaha" />
																	<input type="hidden" value="1"
																		name="paramMap.materAuthTypeId" />
																	<center>
																		<input type="button" value="保存" class="bcbtn"
																			id="jc_btn" />
																	</center>
																</td>
															</tr>
														</table>
													</div>
												</div>
											</div>
										</div>
									</div>

									<div>
										<!-- 弹出层结束  end -->
									</div>
									<!-- 身份证认证结束 end -->
								</div>
							</form>
						</div>
					</div>
				</div>
			</div>
		</div>
		<!-- 引用底部公共部分 -->
		<jsp:include page="/include/footer.jsp"></jsp:include>
		<script type="text/javascript" src="script/jquery-1.7.1.min.js"></script>
		<script type="text/javascript" src="script/jquery.shove-1.0.js"></script>
		<script type="text/javascript" src="script/nav-zh.js"></script>
		<script type="text/javascript" src="common/date/calendar.js"></script>
		<script type="text/javascript" src="css/popom.js"></script>
		<script type="text/javascript" src="script/fancybox.js"></script>
		<script type="text/javascript"
			src="script/jbox/jquery.jBox-2.3.min.js"></script>
		<script type="text/javascript" src="script/jbox/jquery.jBox-zh-CN.js"></script>

		<script>
function showloading(){
    jQuery("body").append("<div class='fullbg'></div>");
    jQuery(".fullbg").css("display","block");
}

// 隐藏层
function hideloading(){
    jQuery(".fullbg").css("display","none");
}

</script>

		<script>
$(function(){
	$('.tabmain').find('li').click(function(){
	$('.tabmain').find('li').removeClass('on');
	$(this).addClass('on');
	$('.lcmain_l').children('div').hide();
    $('.lcmain_l').children('div').eq($(this).index()).show();
	})
	})
</script>
		<script>
$(function(){
	$('.til01 li').click(
	function(){
		$('.til01 li').removeClass('on');
		$(this).addClass('on');
		$('.rmainbox').children('div').hide();
		$('.rmainbox').children('div').eq($(this).index()).show();
	}
	)
})
</script>
		<script> 



function dd(data){

window.parent.showbigpictur($("#ddss"+data+" img").attr("src"))//调用父类的方法
}

$('#gggd').on('click',function(){
 layer.close(i);
});

</script>
		<script>
$(function(){
	$('#scbtn01').click(
	function(){
		$('.tcbox').show();
	}
	)
	$('#gbtck').click(
	function(){
		$('.tcbox').hide();
	}
	)
})
</script>

		<script>
//放大图片
function ddimg(data){
window.parent.showbigpictur($("#ddssa"+data+" img").attr("src"))//调用父类的方法
}

</script>
		<script>
function chan(data){
  var va =  $(data).attr("id");
  var gee = $("#hh_"+va).attr("value");
 
  if(data.checked){
     $(data).attr("value",gee+".v");
   }else{
     $(data).attr("value",gee);
   }
}
</script>

		<script>
//保存图片
$(function(){
  var paramimg = {};
  var gimg = 0;
  $("#bt_sub_1").click(function(){
    //$("#myform").submit();
    $("input[name=rmlink]").each(function() {  
            gimg++;
            paramimg["paramMap.img"+gimg] = $(this).val();
      }); 
      
    paramimg["paramMap.tmid"] ='${tmid }';
    paramimg["paramMap.materAuthTypeId"] = '1';
    paramimg["paramMap.len"] = gimg;
    paramimg["paramMap.listlen"] = '${len}';
    $.post("addpastPicturdate.do",paramimg,function(data){
    if(data==1){ alert("身份证只能上传5张图片");}
    if(data==17){ alert("上传失败");}
    if(data==18){ alert("上传失败");}
    if(data==321){ alert("上传失败");}
    if(data==123){
     window.parent.ffff()//关闭弹出窗口
    }
   })   
   gimg = 0 ;  
   
  });

});

</script>
		<script>
$(function(){
 $("#dd").click(function(){
 var ttt = $("#tat").val();
 window.parent.ffff(ttt,'${id}')
 });
});
</script>
		<script>
//删除图片
function deltemp(data){
 var dt = $(data).attr("id")
 $("#s_"+dt).remove();
}
</script>
		<script>
  var gggg;
			//上传函数
			function updateFiledate(data){
			  gggg = "img"+$(data).attr("id");
			  var dir = getDirNum();
					var json = "{'fileType':'JPG,BMP,GIF,TIF,PNG','fileSource':'user/"+dir+"','fileLimitSize':0.5,'title':'上传图片','cfn':'uploadCall','cp':'img'}";
					json = encodeURIComponent(json);
					 window.showModalDialog("uploadFileAction.do?obj="+json,window,"dialogWidth=500px;dialogHeight=400px");
		
			}
			
			
			
			function uploadCall(basepath,fileName,cp){
		  		if(cp == "img"){
		  		var path = "upload/"+basepath+"/"+fileName;
				$("#"+gggg).val(path);
				return ;
		  		}
			}
			
			function getDirNum(){
		      var date = new Date();
		 	  var m = date.getMonth()+1;
		 	  var d = date.getDate();
		 	  if(m<10){
		 	  	m = "0"+m;
		 	  }
		 	  if(d<10){
		 	  	d = "0"+d;
		 	  }
		 	  var dirName = date.getFullYear()+""+m+""+d;
		 	  return dirName; 
			}
			
		</script>

		<script>
$(function() {  
    $("#select").click(function() {  
        if ($(this).attr("checked")) {  
            $("input[name=items]").each(function() {  
                $(this).attr("checked", true);  
            });  
              $("input[name=itemss]").each(function() {  
                $(this).attr("checked", true);  
                 var ip = $(this).attr("id");
                 var p =  $("#hh_"+ip).attr("value");
                 $(this).attr("value", p+".v"); 
            });  
            
        } else {  
            $("input[name=items]").each(function() {  
                $(this).attr("checked", false);  
            });  
              $("input[name=itemss]").each(function() {  
                $(this).attr("checked", false); 
                       var ip = $(this).attr("id");
                 var p =  $("#hh_"+ip).attr("value");
                 $(this).attr("value", p);  
            });
        }  
        });
 });  
</script>



		<script>
  var  type=0  ;
   var gouble = 2;
   var gd = 1;
$(function(){

   //处理类型身份证5张 等等其他的
  $("#addInput").click(function(){
   type =1;
   
   
    //获取input框内的值的个数
        var countinput = 0;
         $("input[name=rmlink]").each(function() {  
           countinput++
         }); 
         
         
   if(type == 1){
      if(countinput>=5){
      alert("身份证只能上传5张图片");
      }
      if(countinput<5){
       if(gd==1){
       $("#mytable").after("<tr  id='tr"+gouble+"'><td>&nbsp;</td><td><input type='text' class='inp188' id='img"+gouble+"' name='rmlink' disabled='disabled'/>  <a href='javascript:void(0)' class='scbtn' id='"+gouble+"' onclick='updateFiledate(this)'>浏览</a>  <a  href='javascript:void(0)' class='shanchu' onclick='del(this)' id ='"+gouble+"'>删除</a></td></tr>");
         gouble++; 
          gd++;
      }else{
      $("#tr"+(gouble-1)).after("<tr  id='tr"+gouble+"'><td>&nbsp;</td><td><input type='text' class='inp188' id='img"+gouble+"' name='rmlink' disabled='disabled'/>  <a href='javascript:void(0)' class='scbtn' id='"+gouble+"' onclick='updateFiledate(this)'>浏览</a>  <a  href='javascript:void(0)' class='shanchu' onclick='del(this)' id ='"+gouble+"'>删除</a></td></tr>");
          gouble++;  
      }
         
  
         
             }
        }
         
    }); 

});

</script>
		<script>
 //得到选中的值，ajax操作使用  
 $(function(){
    var gv = 0 ;
     var param = {};
     $("#sub").click(function() {  
        var text="";  
        $("input[name=items]").each(function() {  
            if ($(this).attr("checked")) {  
               // alert($(this).val()); 
                gv++;
                param["paramMap.id"+gv] = $(this).val();
            }  
        });  
           param["paramMap.len"] = gv;
           if(gv!=0){
           param["paramMap.tmidStr"]= ${tmidStr};
           $.post("updatevisiable.do",param,function(data){
             alert("操作成功");
             window.location.reload();//刷新页面
              }); 
               }
           gv=0;
    }); 
 
 });
</script>
		<script>
function del(data){
 var dt = $(data).attr("id")
 $("#tr"+dt).remove();
 gouble = $(data).attr("id");
}
</script>
		<script>
	function sure(data) {
		var llen = '${len}';
		$('#s_' + llen)
				.after(
						"<tr  id='s_"
								+ (llen + 1)
								+ "> __tag_1228$47_--__tag_1228$68_<td align='center'>12__tag_1228$94_<td align='center'>5454__tag_1228$122_<td align='center' class='pic'>img__tag_1228$161_<td al
</script>
		<script>
  $(function(){
    if('${map.auditStatus}'=='3'){
       $("#province").attr("disabled","true");
       $("#registedPlacePro").attr("disabled","true");
       $("#city").attr("disabled","true");
       $("#registedPlaceCity").attr("disabled","true");
       $("#clickCode").hide();
    }
  });



</script>
		<script>
$(function(){
	dqzt(4);
  var t = '${map.idNo}'==''?'':'${map.idNo}';
  var len = t.length;
  
  if(len==15){
  var tmplen = t.substr(0,2);
  
  $('#idNo1').html(tmplen+'***** **** ****');  
  }else if(len==18){
  var tttttt = t.substr(0,2);
  $('#idNo1').html(tttttt+'**** **** **** ****');  
  }
  
  //alert(t.substr);
  
  var tt = '${map.cellPhone}'==''?'':'${map.cellPhone}';
  var len1 = tt.length;
  var tmplen1;
  var tmplen2;
  if(len1!=0){
  tmplen1 = tt.substr(0,3);
  tmplen2 = tt.substr(7,11);
  $('#cellPhone1').html(tmplen1+' **** '+tmplen2); 
  }
}
);
<%--  $("#grtx").hide(); --%>
	
</script>
		<script type="text/javascript">
	//提交基本资料 start-->
	var timers = 180;
	var tipId;
	var flags = false;
	$(function() {
		//当用户再次输入手机号码时候 add by lw
		$("#cellPhone").change(
				function() {
					var phone = $("#cellPhone").val();
					if ($("#cellPhone").val() == "") {
						$("#u_cellPhone").attr("class", "formtips onError");
						$("#u_cellPhone").html("请填写手机号码！");
					} else if ((!/^1[3,4,5,8]\d{9}$/
							.test($("#cellPhone").val()))) {
						$("#u_cellPhone").attr("class", "formtips onError");
						$("#u_cellPhone").html("请正确填写手机号码！");
					} else {
						$("#u_cellPhone").attr("class", "formtips");
						$("#u_cellPhone").html("");
						if ($("#clickCode5").html() != "重新发送验证码"
								|| $("#clickCode").html() != "点击获取验证码") {
							//当处在发送中的状态时候
							window.clearInterval(tipId);
							flags = false;
							$("#clickCode5").html("点击获取验证码");
							$.post("removeCode.htm", "", function(data) {
							});//删除手机验证码
						}
					}
				});

		$("#clickCode5").click(function() {
			//验证手机号码
				if ($("#cellPhone").val() == "") {
					$("#u_cellPhone").attr("class", "formtips onError");
					$("#u_cellPhone").html("请填写手机号码！");
				} else if ((!/^1[3,4,5,8]\d{9}$/.test($("#cellPhone").val()))) {
					$("#u_cellPhone").attr("class", "formtips onError");
					$("#u_cellPhone").html("请正确填写手机号码！");
				} else {
					$("#u_cellPhone").attr("class", "formtips");
					$("#u_cellPhone").html("");
					if ($("#clickCode5").html() == "重新发送验证码"
							|| $("#clickCode5").html() == "点击获取验证码") {
						if (flags)
							return;
						var phone = $("#cellPhone").val();
						$.post("phoneCheck.htm", "phone=" + phone, function(
								datas) {
							if (datas.ret != 1) {
								alert(datas.msg);
								return;
							}
							phone = datas.phone;
							var test = {};
							test["paramMap.phone"] = phone;
							$.post("sendSMS.htm", test, function(data) {
								if (data == 1) {
									timers = 180;
									flags = true;
									tipId = window
											.setInterval("timer_()", 1000);
								} else {
									alert("手机验证码发送失败");
								}
							});
						});
					}
				}
			});
	});
	//定时
	function timer_() {

		if (timers >= 0) {
			$("#clickCode5").html("验证码获取：" + timers + "秒");
			timers--;
		} else {
			window.clearInterval(tipId);
			flags = false;
			$("#clickCode5").html("重新发送验证码");
			$.post("removeCode.htm", "", function(data) {
			});

		}
	}
	//======
	$(document)
			.ready(
					function() {
						$("#BaseDataform :input")
								.blur(function() {
									//验证手机号码
										if ($(this).attr("id") == "cellPhone") {
											if ($(this).val() == "") {
												$("#u_cellPhone").attr("class",
														"formtips onError");
												$("#u_cellPhone").html(
														"请填写手机号码！");
											} else if ((!/^1[3,4,5,8]\d{9}$/
													.test($("#cellPhone").val()))) {
												$("#u_cellPhone").attr("class",
														"formtips onError");
												$("#u_cellPhone").html(
														"请正确填写手机号码！");
											} else {
												$("#u_cellPhone").attr("class",
														"formtips");
												$("#u_cellPhone").html("");
											}
										}
										//真实姓名
										if ($(this).attr("id") == "realName") {
											var isName = new Object();
											isName = /^[a-zA-Z\u4e00-\u9fa5]+$/;
											if ($(this).val() == "") {
												$("#u_realName").attr("class",
														"formtips onError");
												$("#u_realName").html(
														"请填写真实姓名！");
											} else if ($(this).val().length < 2
													|| $(this).val().length > 20) {
												$("#u_realName").attr("class",
														"formtips onError");
												$("#u_realName").html(
														"名字长度为2-20个字符");
											} else if (!isName.test($(this)
													.val())) {
												$("#u_realName").html(
														"真实姓名输入有误");
											} else {
												$("#u_realName").attr("class",
														"formtips");
												$("#u_realName").html("");
											}
										}
										//========
										//身份号码
										if ($(this).attr("id") == "idNo") {
											var isIDCard1 = new Object();
											var isIDCard2 = new Object();
											//身份证正则表达式(15位) 
											isIDCard1 = /^[1-9]\d{7}((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])\d{3}$/;
											//身份证正则表达式(18位) 
											isIDCard2 = /^[1-9]\d{5}[1-9]\d{3}((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])((\d{4})|\d{3}(x|X))$/;
											if ($(this).val() == "") {
												//$("#u_idNo").attr("class", "formtips onError");
												$("#u_idNo").html("请填写身份证号码");
											} else if (isIDCard1.test($(this)
													.val())
													|| isIDCard2.test($(this)
															.val())) {
												//验证身份证号码的有效性
												var parama = {};
												parama["paramMap.idNo"] = $(
														this).val();
												$
														.post(
																"isIDNO.htm",
																parama,
																function(data) {
																	if (data.putStr == "0") {
																		$(
																				"#u_idNo")
																				.html(
																						"请填写身份证号码");
																	} else if (data.putStr == "1") {
																		$(
																				"#u_idNo")
																				.html(
																						"身份证号码不合法!");
																	} else {
																		$(
																				"#u_idNo")
																				.html(
																						"");
																	}
																});
											} else {
												$("#u_idNo").html("身份证号码不正确");
											}
										}
										//========== 验证出生年月
										if ($(this).attr("id") == "birthday") {
											if ($(this).val() != "") {
												$("#u_birthday").html("");
											}
										}
										//==手机验证码
										if ($(this).attr("id") == "vilidataNum") {
											if ($(this).val() == "") {
												$("#u_vilidataNum").attr(
														"class",
														"formtips onError");
												$("#u_vilidataNum").html(
														"请填写手机验证码");
											} else {
												$("#u_vilidataNum").attr(
														"class", "formtips");
												$("#u_vilidataNum").html("");
											}
										}
										//================居住电话
										if ($(this).attr("id") == "telephone") {
											var mdd = /^((0\d{2,3})-)(\d{7,8})(-(\d{3,}))?$/;
											if ($(this).val() == "") {
												//   $("#u_telephone").attr("class", "formtips onError");
												//   $("#u_telephone").html("请填写居住电话");
											} else if (!mdd.test($(this).val())) {
												$("#u_telephone").attr("class",
														"formtips onError");
												$("#u_telephone").html(
														"请填写正确的居住电话");
											} else {
												$("#u_telephone").attr("class",
														"formtips");
												$("#u_telephone").html("");
											}
										}
										//============
									});
						$("#province").change(function() {
							var provinceId = $("#province").val();
							citySelectInit(provinceId, 2);
						});
						$("#registedPlacePro").change(function() {
							var provinceId = $("#registedPlacePro").val();
							registedPlaceCity(provinceId, 2);
						});

					});
	function registedPlaceCity(parentId, regionType) {
		var _array = [];
		_array.push("__tag_464$15_--请选择--__tag_464$41_");
		var param = {};
		param["regionType"] = regionType;
		param["parentId"] = parentId;
		$.post("ajaxqueryRegion.htm", param, function(data) {
			for ( var i = 0; i < data.length; i++) {
				_array.push("__tag_470$17_" + data[i].regionName
						+ "__tag_470$76_");
			}
			$("#registedPlaceCity").html(_array.join(""));
		});
	}

	function citySelectInit(parentId, regionType) {
		var _array = [];
		_array.push("__tag_481$15_--请选择--__tag_481$41_");
		var param = {};
		param["regionType"] = regionType;
		param["parentId"] = parentId;
		$.post("ajaxqueryRegion.htm", param, function(data) {
			for ( var i = 0; i < data.length; i++) {
				_array.push("__tag_487$17_" + data[i].regionName
						+ "__tag_487$76_");
			}
			$("#city").html(_array.join(""));
		});
	}

	//上传的类型
	var typed ='1';
	
	//提交基础资料
	$("#jc_btn").click(function() {

		var param = {}; //定义数组
		
		var tsex = '${map.sex}' == '' ? '' : '${map.sex}';
		if ($("#realName").val() == "") {
			// $("#u_realName").html("请填写真实姓名！");
			alert("请填写真实姓名！");
			return false
		}
		if ($("#idNo").val() == "") {
			// $("#u_idNo").html("请填写身份号码！");
			alert("请填写身份号码！");
			return false
		}
		if ($("#cellPhone").val() == "") {
			//$("#u_cellPhone").html("请填写手机号码！");
			alert("请填写手机号码！");
			return false
		}

		if ($("#vilidataNum").val() == "") {
			// $("#u_vilidataNum").html("请填写手机验证码");
			alert("请填写手机验证码！");
			return false
		}

		if ($("#img").attr("src") == "") {
			alert("请上传您的个人头像");
			return false;
		}
		

		//图片上传的方法 start
		var visable1 = 0;
	    var visable3 = 0;
	   //获取本来在数据库的图片获取他们的id
	     $("input[name=items]").each(function() { 
	       visable3++;
	     });
	   
	    $("input[name=items]").each(function() { 
	      if ($(this).attr("checked")) {  
	                visable1++;
	             param["paramMap.id"+visable1] = $(this).val();
	            }  
	     });
	     //取上传到tomcat的图片的地址和是否选择
	       var visable2 = 0;
	       $("input[name=itemss]").each(function() { 
	       //获取图片选矿的值
	         visable2++;
	         param["paramMap.ids"+visable2] = $(this).val();
	     });
	     //控制上传个数
	     if(typed=='1'){//身份证
	       if((visable2+visable3)>5){
	        alert("身份证认证图片只能上传5张,如需再上传,请联系客服!谢谢");
	        return false;
	       }
	     }
		//图片上传的方法 end
		
		$("#jc_btn").attr("disabled", true);
		param["paramMap.realName"] = $("#realName").val();
		param["paramMap.idNo"] = $("#idNo").val();
		param["paramMap.cellPhone"] = $("#cellPhone").val();
		param["paramMap.vilidataNum"] = $("#vilidataNum").val();
		param["paramMap.sex"] = $("input[name='paramMap_sex']:checked").val();
		param["paramMap.birthday"] = $("#birthday").val();
		param["paramMap.highestEdu"] = $("#highestEdu").val();
		param["paramMap.eduStartDay"] = $("#eduStartDay").val();
		param["paramMap.school"] = $("#school").val();
		param["paramMap.maritalStatus"] = $(
				"input[name='paramMap_maritalStatus']:checked").val();
		param["paramMap.hasChild"] = $(
				"input[name='paramMap_hasChild']:checked").val();
		param["paramMap.hasHourse"] = $(
				"input[name='paramMap_hasHourse']:checked").val();
		param["paramMap.hasHousrseLoan"] = $(
				"input[name='paramMap_hasHousrseLoan']:checked").val();
		param["paramMap.hasCar"] = $("input[name='paramMap_hasCar']:checked")
				.val();
		param["paramMap.hasCarLoan"] = $(
				"input[name='paramMap_hasCarLoan']:checked").val();
		param["paramMap.nativePlacePro"] = $("#province").val();
		param["paramMap.nativePlaceCity"] = $("#city").val();

		param["paramMap.registedPlacePro"] = $("#registedPlacePro").val();
		param["paramMap.registedPlaceCity"] = $("#registedPlaceCity").val();

		param["paramMap.address"] = $("#address").val();
		param["paramMap.telephone"] = $("#telephone").val();
		//用户头像路径
		param["paramMap.personalHead"] = $("#img").attr("src");
		param["paramMap.iscellPhone"] = $("#iscellPhone").val();
		param["paramMap.num"] = "1";

		 //图片数据上传到后台
	    param["paramMap.tmid"] ='${tmid }';
	    param["paramMap.materAuthTypeId"] = '1';
	    param["paramMap.listlen"] = '${len}';
	    param["paramMap.len"] = visable2;//将要上传的图片个数

	   if(visable2<1){
		   alert('请上传您的身份证正反面！');
		   return false;
	  }
		
		$.post("updateBasedate.htm", param, function(data) {
			if (data.msg == "保存成功") {
				alert("保存成功");
				window.clearInterval(tipId);
				$("#clickCode5").html("点击获取验证码");
				window.location.reload();
			} else {
				if (data.msg == "保存成功2") {
					alert("保存成功");
					window.clearInterval(tipId);
					$("#clickCode5").html("点击获取验证码");
					window.location.reload();
				}
				$("#jc_btn").attr("disabled", false);
				//alert("请正确填写基本资料");
				if (data.msg == "请正确填写真实名字") {
					//$("#u_realName").html("请填写真实姓名！")
				alert("请填写真实姓名！");
			}
			if (data.msg == "真实姓名的长度为不小于2和大于20") {
				//$("#u_realName").html("真实姓名的长度为不小于2和大于20！")
				alert("真实姓名的长度为不小于2和大于20！");
			}
			if (data.msg == "请正确身份证号码") {
				// $("#u_idNo").html("请正确身份证号码！")
				alert("请正确输入你的身份证号码");
			}
			if (data.msg == "身份证已注册") {
				alert("身份证已注册!");
			}
			if (data.msg == "请正确填写手机号码") {
				// $("#u_cellPhone").html("请填写手机号码！");
				alert("请填写手机号码!");

			}
			if (data.msg == "手机号码长度不对") {
				// $("#u_cellPhone").html("手机号码长度不对！")
				alert("手机号码长度不对！");

			}

			if (data.msg == "手机已存在") {

				alert("该手机号码已经被注册过了！");

			}
			//手机验证码
			if (data.msg == "与获取验证码手机号不一致") {
				// $("#u_cellPhone").html("手机号码长度不对！")
				alert("手机号码与获取验证码手机号不一致！");
			}
			if (data.msg == "请填写验证码") {
				// $("#u_cellPhone").html("手机号码长度不对！")
				alert("请填写验证码");
			}
			if (data.msg == "请重新发送验证码") {
				// $("#u_cellPhone").html("手机号码长度不对！")
				alert("请重新发送验证码");
			}
			if (data.msg == "请输入正确的验证码") {
				// $("#u_cellPhone").html("手机号码长度不对！")
				alert("请输入正确的验证码");
			}
		}
		if (data.msg == "请正确填写手机号码") {
			// $("#u_cellPhone").html("手机号码长度不对！")
			alert("手机验证码填写错误！");
		}
		if (data.msg == "请正确填写性别") {
			// $("#u_cellPhone").html("手机号码长度不对！")
			alert("请勾选填写性别！");
		}
		if (data.msg == "请正确填写出生日期") {
			//$("#u_birthday").html("请正确填写出生日期！")
			alert("请正确填写出生日期！");
		}
		if (data.msg == "请正确填写入学年份") {
			// $("#u_eduStartDay").html("请正确填写入学年份！")
			alert("请正确填写入学年份！");
		}
		if (data.msg == "请正确填写入毕业院校") {
			// $("#u_school").html("请正确填写入毕业院校！")
			alert("请正确填写入毕业院校！");
		}
		if (data.msg == "请正确填写入学年份") {
			//  $("#u_eduStartDay").html("请正确填写入学年份！")
			alert("请正确填写入学年份！");
		}
		if (data.msg == "请正确填写最高学历") {
			//$("#u_highestEdu").html("请正确填写最高学历！")
			alert("请正确填写最高学历！");
		}
		if (data.msg == "请正确填写入籍贯省份") {
			// $("#u_nativePlacePro").html("请正确填写入籍贯省份！")
			alert("请正确填写入籍贯省份！");

		}
		if (data.msg == "请正确填写入籍贯城市") {
			//$("#u_nativePlaceCity").html("请正确填写入籍贯城市！")
			alert("请正确填写入籍贯城市！");

		}
		if (data.msg == "请正确填写入户口所在地省份") {
			//  $("#u_registedPlacePro").html("请正确填写入户口所在地省份！")
			alert("请正确填写入户口所在地省份!");
		}
		if (data.msg == "请正确填写入户口所在地城市") {
			// $("#u_registedPlaceCity").html("请正确填写入户口所在地城市！")
			alert("请正确填写入户口所在地城市!");
		}
		if (data.msg == "请正确填写入你的家庭电话") {
			//$("#u_telephone").html("请正确填写入你的家庭电话！")
			alert("请正确填写入你的家庭电话！");

		}
		if (data.msg == "你的家庭电话输入不正确") {
			//$("#u_telephone").html("请正确填写入你的家庭电话！")
			alert("请正确填写入你的居住电话");
			$(this).show();
		}

		if (data.msg == "你的居住电话输入长度不对") {
			//$("#u_telephone").html("请正确填写入你的家庭电话！")
			alert("你的居住电话输入长度不对");

		}

		if (data.msg == "请正确上传你的个人头像") {
			//$("#u_img").html("个人头像不能为空！")
			alert("个人头像不能为空！");

		}
		if (data.msg == "超时请重新登录") {
			window.location.href = 'login.htm';
		}
		if (data.msg == "身份证不合法") {
			alert("你输入的身份证号码不合法,请重新输入");
			$("#u_idNo").html("请输入正确身份证号码！");

		}
		if (data.msg == "身份证已被注册") {
			alert("你输入的身份证号码身份证已被注册,请重新输入");
			$("#u_idNo").html("请重新输入身份证号码！");

		}
	}	);

	});

	$(function() {
		//上传图片
		$("#btn_personalHead")
				.click(
						function() {
							var dir = getDirNum();
							var json = "{'fileType':'JPG,BMP,GIF,TIF,PNG','fileSource':'user/"
									+ dir
									+ "','fileLimitSize':0.5,'title':'上传图片','cfn':'uploadCall','cp':'img'}";
							json = encodeURIComponent(json);
							window.showModalDialog("uploadFileAction.htm?obj="
									+ json, window,
									"dialogWidth=500px;dialogHeight=400px");
							var headImgPath = $("#img").attr("src");
							if (headImgPath != "") {
								//window.location.href="updateHeadImg.htm?userHeadImg="+headImgPath;	
								$("#u_img").html("");
							} else {
								alert("上传失败！");
							}
						});

	});

	function uploadCall(basepath, fileName, cp) {
		if (cp == "img") {
			var path = "upload/" + basepath + "/" + fileName;
			$("#img").attr("src", path);
			$("#setImg").attr("src", path);
		}
	}

	function getDirNum() {
		var date = new Date();
		var m = date.getMonth() + 1;
		var d = date.getDate();
		if (m < 10) {
			m = "0" + m;
		}
		if (d < 10) {
			d = "0" + d;
		}
		var dirName = date.getFullYear() + "" + m + "" + d;
		return dirName;
	}
	//======================工作认证

	//===============|~

	$(function() {
		$('#li_16').addClass('on');
		$("#jk_hover div").removeClass('none');
	});

	//end
</script>

		<script>
	function jumpUrl(obj) {
		window.location.href = obj;
	}
	//工作认证
	function loadWorkInit(url) {
		var bb = '${person}';//填写工作信息必须先填写个人资料
		if (bb == "0") {
			alert("请先完善个人信息");
			window.location.href = "owerInformationInit.htm";
		} else {
			window.location.href = url;
		}
	}
	//加载该用户提现银行卡信息
	function loadBankInfo(url) {
		var bb = '${person}';//设置提现银行卡必须先填写个人资料
		if (bb == "0") {
			alert("请先完善个人信息");
			window.location.href = "owerInformationInit.htm";
		} else {
			window.location.href = url;
		}

	}

	function bindingPhoneLoad(url) {
		window.location.href = url;
	}
</script>

		<script>
	function changeBankInfos(id) {
		var url = "queryOneBankInfo.htm?bankId=" + id;
		jQuery.jBox.open("post:" + url, "银行卡变更", 600, 400, {
			buttons : {}
		});
	}
</script>
		<script>
	//从子窗口返回的函数
	var photo_w;
	var photo_y;
	function showbigpictur(data) {
		//data图片路径
		if (1) {
			$("#imagesa").attr("src", data);//将图片的值付给

			if (1) {
				$('#fancybox').trigger("click");//触发单击事件
				photo_w = $('#imagesa').css('width');
				photo_y = $('#imagesa').css('height');
				$("#imagesa").css("width");
				$("#imagesa").css("height");
				setTimeout("", 10000);
			}
		}
		//.....
	}
</script>

		<script type="text/javascript">
	$(document).ready(function() {
		$("#fancybox").fancybox( {
			'onClosed' : function() {
				$('#imagesa').attr("style", "");
			}//关闭时候调用
			});
		// 还原
			$('#normal').click(function() {
				$('#imagesa').css('width', photo_w);
				$('#imagesa').css('height', photo_y);
				$('#fancybox').click();
			});
			// 放大
			$('#big').click(function() {
				var photoWidth = parseInt($('#imagesa').css("width"));
				var w = photoWidth + photoWidth * 0.1;
				var photoHeight = parseInt($('#imagesa').css("height"));
				var h = photoHeight + photoHeight * 0.1;
				$('#imagesa').css('width', w + 'px');
				$('#imagesa').css('height', h + 'px');
				$('#fancybox').click();
			});

			//缩小
			$('#small').click(function() {
				var photoWidth = parseInt($('#imagesa').css("width"));
				var w = photoWidth - photoWidth * 0.1;
				var photoHeight = parseInt($('#imagesa').css("height"));
				var h = photoHeight - photoHeight * 0.1;
				$('#imagesa').css('width', w + 'px');
				$('#imagesa').css('height', h + 'px');
				$('#fancybox').click();
			});
		});
</script>

		<script type="text/javascript">
	/*function fff(data) {
		var t = $(data).attr("sd");
		$.jBox("iframe:showpastpictur.htm?dm=" + t, {
			title : "上传",
			width : 520,
			height : 430,
			buttons : {}
		});
	}*/

	function fff() {
		$("#tanchu").show();
		$("#shencard").hide();
		$("#uploadOk").show();
		$("#uploadNo").show();
	}

     $("#uploadNo").click(function(){
    	 $("#uploadOk").hide();
 		 $("#uploadNo").hide();
    	 $("#tanchu").hide();
    	 $("#shencard").show();
        });
	
	function ffff() {
		window.parent.window.jBox.close();
		window.location.reload();
	}
</script>
		<script>

$(function() {
	dqzt(4);
	$('#li_16').addClass('on');
	$("#jk_hover div").removeClass('none');
});
</script>
		<script type="text/javascript"
			src="script/jbox/jquery.jBox-2.3.min.js"></script>
		<script type="text/javascript" src="script/jbox/jquery.jBox-zh-CN.js"></script>
		<script>
//上传图片
        var flag = false;
        var gv1 = 0 ;
        var gv2 = 0 ;
        var allgv = 0;
		
			function updateFiledatefirest(data){

				//--------------------基本信息验证开始
				var realName=$("#realName").val();
				var isName = new Object();
				isName = /^[a-zA-Z\u4e00-\u9fa5]+$/;
				if(realName==""){
					$("#u_realName").html("真实姓名不能为空！");
					return false;
				}
				if(!isName.test(realName)){
					$("#u_realName").html("真实姓名语法不对！");
					return false;
				}
					
				var idNo=$("#idNo").val();
				var isIDCard1 = new Object();
				var isIDCard2 = new Object();
				//身份证正则表达式(15位) 
				 isIDCard1 =  /(^\d{15}$)|(^\d{17}(\d|X)$)/; 
				//身份证正则表达式(18位) 
				 isIDCard2 =  /^(\d{6})(\d{4})(\d{2})(\d{2})(\d{3})([0-9]|X)$/;
				if(idNo==""){
					$("#u_idNo").html("身份证号码不能为空！");
					return false;
				}
				if(!isIDCard1.test(idNo)||!isIDCard2.test(idNo)){
					$("#u_idNo").html("身份证号码不合法！");
					return false;
				}

				var cellPhone=$("#cellPhone").val();
				if((!/^1[3,4,5,8]\d{9}$/
						.test(cellPhone))){
					$("#u_cellPhone").html("手机号码输入不正确！");
					return false;
				}
				if(cellPhone==""){
					$("#u_cellPhone").html("手机号码不能为空！");
					return false;
				}

				var vilidataNum=$("#vilidataNum").val();
					if(vilidataNum==""){
						$("#u_vilidataNum").html("短信验证码不能为空！");
						return false;
					}
				//----------------------基本信息验证结束
				
			showloading();
			var dir = getDirNum();
			var json = "{'fileType':'JPG,BMP,GIF,TIF,PNG','fileSource':'user/"+dir+"','fileLimitSize':1,'title':'上传图片','cfn':'uploadCall2','cp':'img'}";
			json = encodeURI(encodeURI(json));
		    window.showModalDialog("uploadFileAction.do?obj="+json,window,"dialogWidth=500px;dialogHeight=400px");
					//var headImgPath = $("#img").attr("value");
				   //if(headImgPath!=""){
			       //}
			hideloading();
		    }

		function uploadCall2(basepath,fileName,cp){
		   		//检测上传个数 如果达到了上传上限 那么给予提示
			$("input[name=items]").each(function() {  
                  gv1++;
            }); 
			 $("input[name=itemss]").each(function() {  
                 gv2++;
             });  
			
			allgv = gv1+gv2;
		  
		  	if(cp == "img"){
		  	var path = "upload/"+basepath+"/"+fileName;
		  		//$("#img1").attr("value",path);
		  		//处理文件上传
		  	var Idd = $('#sssd tr:last').prev().attr("id");
		  	var te =  parseInt($("#"+Idd+" td:eq(1)").text());
		  	if(isNaN(te)){
		  	te = 0;
		  	}
		  	var charStr = "";
		  //	if('${typmap.materAuthTypeId}'=='1'){charStr="身份证"+(te+1)}
		     charStr="身份证"+(te+1);
		  //$("#"+Idd).after('<tr  id="s_'+(allgv+1)+'"><td align="center"><input type="checkbox" name="itemss" id="'+(allgv+1)+'" value="'+path+'"  onchange="chan(this)"   /><input type="hidden" value="'+path+'" id="hh_'+(allgv+1)+'"/></td><td align="center"></td><td align="center"></td> <td align="center" class="pic" ><img src="'+path+'" width="62" height="62"/></td><td align="center"> 待提交 </td><td align="center"><a  href="javascript:void(0)"   onclick="deltemp(this)" id ="'+(allgv+1)+'">删除</a></td>');	
		  $("#"+Idd).after('<tr  id="s_'+(allgv+1)+'"><td align="center"><input type="checkbox" name="itemss" id="'+(allgv+1)+'" value="'+path+'"  onchange="chan(this)"   /><input type="hidden" class="renimagePath" value="'+path+'" id="hh_'+(allgv+1)+'"/></td><td align="center">'+(te+1)+'</td><td align="center">'+charStr+'</td> <td align="center" class="pic" ><a href="'+path+'" target="_blank" title="查看图片"><img    src="'+path+'" width="62" height="62"/></a>  <a  id="ddssa'+(allgv+1)+'" style="display: none;"> <img src="'+path+'" width="400" height="400"/></a></td><td align="center"> 待提交 </td><td align="center"><a  href="javascript:void(0)"   onclick="deltemp(this)" id ="'+(allgv+1)+'">删除</a></td>');	
		  
		    te = 0;
		   hideloading();
		    
		    
		    
		    
		  		}
			}
</script>
		<script>
function showloading(){
    jQuery("body").append("<div class='fullbg'></div>");
    jQuery(".fullbg").css("display","block");
}

// 隐藏层
function hideloading(){
    jQuery(".fullbg").css("display","none");
}




</script>
	</body>
</html>
